---
title: "App Store Connect APIã‚’ä½¿ã£ã¦ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ã‚’å–å¾—ã™ã‚‹"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python","Apple"]
published: true
---

ã¤ã„æœ€è¿‘[å€‹äººé–‹ç™º](https://apps.apple.com/jp/app/countdays/id6469093293)ã‚¢ãƒ—ãƒªã‚’ã ã—ã€ãã®ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ã¨ã‹ã‚’app storeã®analyticsã§è¦‹ã¦ã„ãŸã®ã§ã™ãŒã€ã„ã¡ã„ã¡è¦‹ã«è¡Œãã®ãŒé¢å€’ãã•ã‹ã£ãŸã‚Šã€Slackç­‰ã¨é€£æºã—ãŸã‹ã£ãŸã®ã§ã€ã‚¢ãƒ—ãƒªã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã®æ•°å­—ã‚’ã¨ã£ã¦ãã‚Œã‚‹ã„ã„æ„Ÿã˜ã®ãªã„ã‹ãªã€œã¨æ¢ã—ãŸã¨ã“ã‚ã€[Appleã‹ã‚‰å…¬å¼ã®API](https://developer.apple.com/documentation/appstoreconnectapi)ãŒå‡ºã¦ã„ãŸã®ã§ã€ã“ã‚Œã‚’ä½¿ã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

ä»•æ§˜ã¨ã—ã¦ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ã‚„èª²é‡‘ç™»éŒ²æ•°ãªã©ã‚’ä¸€æ—¥ä¸€å›Slackç­‰ã«é€šçŸ¥ã—ã¦ãã‚Œã‚‹ã€ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚

ä¹…ã—ã¶ã‚Šã«ã“ã†ã„ã†ã®ã‚’ä½œã£ã¦ã¿ã‚‹ã¨ã„ã†ã“ã¨ã§ã€æ ¼å®‰ã‚µãƒ¼ãƒãƒ¼ã‚’æ¢ã—ã¦ã¿ã¾ã—ãŸã€‚
ä»¥å‰ã¯HerokuãŒå€‹äººé–‹ç™ºè€…ç”¨ã®ä»£è¡¨çš„ã‚µãƒ¼ãƒ“ã‚¹ã ã£ãŸã®ã§ã™ãŒã€è‡ªåˆ†ãŒæ¥­ç•Œé›¢ã‚Œã¦ã„ã‚‹é–“ã«ç„¡æ–™ãƒ—ãƒ©ãƒ³ãŒçµ‚äº†ã—ã¦ã„ãŸã‚ˆã†ã§ã™ã€‚

https://forest.watch.impress.co.jp/docs/news/1435422.html

ã¨ã„ã†ã“ã¨ã§ã€ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ¢ã—ã¦ã¿ã¦ã€çµæœçš„ã«GCPãŒä¸€ç•ªè‰¯ã•ãã†ã€ã£ã¦ã“ã¨ã«è½ã¡ç€ãã¾ã—ãŸã€‚

ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«è‡ªåˆ†ã§ãƒ†ã‚¹ãƒˆã—ãŸã‹ã£ãŸã®ã§ã€æœ‰åãªAPIãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Postmanã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚
ã—ã‹ã—ã€ã¡ã‚‡ã£ã¨å•é¡ŒãŒã‚ã£ã¦çµå±€Postmanã¯ä½¿ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ï¼ˆç†ç”±ã¯å¾Œè¿°ï¼‰

ä»Šå›ã®App Store Connect APIã¯JWTèªè¨¼ã‚’ä½¿ã£ãŸAPIã¨ã„ã†ã“ã¨ã§ã—ãŸã€‚
JWTèªè¨¼ã«ã¤ã„ã¦ã¯ç”ŸæˆAIã®Bardã§ã“ã®ã‚ˆã†ã«èª¬æ˜ã—ã¾ã™ã€‚ï¼ˆJWTèªè¨¼ã«ã¤ã„ã¦ã¯è‡ªåˆ†ã§èª¿ã¹ãŸã®ã§ã€å†…å®¹è‡ªä½“ã¯é–“é•ã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿ã§ã™ã€‚ï¼‰

> JWTã¯ã€ä»¥ä¸‹ã®3ã¤ã®éƒ¨åˆ†ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚
> - ãƒ˜ãƒƒãƒ€ãƒ¼
> - ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
> - ç½²å
>
>ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¯ã€JWTã®å½¢å¼ã¨ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®IDã‚„æ¨©é™ãªã©ã®æƒ…å ±ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
ç½²åã«ã¯ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’çµ„ã¿åˆã‚ã›ã¦ç”Ÿæˆã—ãŸãƒãƒƒã‚·ãƒ¥å€¤ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
JWTèªè¨¼ã§ã¯ã€ã¾ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¡Œã„ã¾ã™ã€‚èªè¨¼ã‚µãƒ¼ãƒãƒ¼ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ã€èªè¨¼ã«æˆåŠŸã—ãŸå ´åˆã¯ã€JWTã‚’ç”Ÿæˆã—ã¾ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€ã“ã®JWTã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«æŒ‡å®šã—ã¦ã€APIã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã™ã€‚APIã‚µãƒ¼ãƒãƒ¼ã¯ã€JWTã®ç½²åã‚’æ¤œè¨¼ã—ã¦ã€æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã‚ã‚Œã°ã€APIã‚µãƒ¼ãƒãƒ¼ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã‚’å‡¦ç†ã—ã¾ã™ã€‚
JWTèªè¨¼ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚
> - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§èªè¨¼æƒ…å ±ã‚’ä¿æŒã™ã‚‹å¿…è¦ãŒãªã„ãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒå‘ä¸Šã™ã‚‹
> - èªè¨¼ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰APIã‚µãƒ¼ãƒãƒ¼ã«èªè¨¼æƒ…å ±ã‚’æ¸¡ã™å¿…è¦ãŒãªã„ãŸã‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã™ã‚‹
> - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã‚‚åˆ©ç”¨ã§ãã‚‹
JWTèªè¨¼ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯ã€ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚
> - ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®é¸æŠãŒé‡è¦ã§ã‚ã‚‹
> - ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒè„†å¼±åŒ–ã—ãŸå ´åˆã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒæ”¹ã–ã‚“ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
>
> JWTèªè¨¼ã¯ã€APIãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ˆãåˆ©ç”¨ã•ã‚Œã‚‹èªè¨¼æ–¹å¼ã§ã™ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸¡ç«‹ã§ãã‚‹ãŸã‚ã€å¤šãã®ä¼æ¥­ã§æ¡ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
(Bardã‚ˆã‚Šç”Ÿæˆï¼šprompt, JWTèªè¨¼ã«ã¤ã„ã¦ã‚ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ãã ã•ã„)

ã“ã‚Œã‚’Postmanã§ã‚„ã‚ã†ã¨ã—ãŸã®ã§ã™ãŒã€JavaScriptã—ã‹ã§ããªãã€requireã§moduleã‚’importãŒã§ããªã‹ã£ãŸã®ã§æ™‚é–“ã‹ã‹ã‚Šãã†ã ã£ãŸãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚„ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚(Postmanã‚’è¾ã‚ãŸç†ç”±ã®ä¼ç·šå›å)

App Store Connect APIã®æµã‚Œã¨ã—ã¦ã¯ã€
1. è‡ªåˆ†ã®èªè¨¼æƒ…å ±ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦JWT tokenã‚’ç™ºè¡Œ
2. ç™ºè¡Œã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã§APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ
3. ãƒªã‚¯ã‚¨ã‚¹ãƒˆæˆåŠŸã—ãŸã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æƒ…å ±ç­‰ãŒå«ã¾ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ã‚‰ã‚Œã¦ãã‚‹ã€‚å½¢å¼ã¯gzip

JWT tokenã¯æœ€å¤§20åˆ†æœ‰åŠ¹ãªãŸã‚ã€ãã®æœ‰åŠ¹æœŸé–“ã§ã‚ã‚Œã°JWT tokenã‚’ç™ºè¡Œã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ä»Šå›ã¯ãƒ†ã‚¹ãƒˆã®æ®µéšã ã£ãŸã®ã§ã€éƒ½åº¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™ã€‚

ãã‚Œã§ã¯æµã‚Œã«ãã£ã¦å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

## 1. è‡ªåˆ†ã®èªè¨¼æƒ…å ±ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦JWT tokenã‚’ç™ºè¡Œ
JWTãƒˆãƒ¼ã‚¯ãƒ³ã¯header, payload, signatureã®ï¼“ã¤ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚
headerã¨payloadã¯å…¬é–‹ã•ã‚Œã¦ãŠã‚Šã€ã“ã®ï¼’ã¤ã‹ã‚‰ç§˜å¯†éµã‚’ç”¨ã„ã¦ã€signatureã‚’ç”Ÿæˆã—ã¾ã™ã€‚[Generating Tokens for API Requests](https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests)

App Store APIã®headerã¯3ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‚Šã¾ã™
``` Python
headers = {
    "alg": "ES256",
    "kid":"Your Private Key ID ex. 2X9R4HXF34.",
    "typ": "JWT",
}
```

ã“ã®kidã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€App Store Connect APIã®Keyã‚’ç™ºè¡Œã—ã¾ã™ã€‚
App Store Connectâ†’User and Accessâ†’Keys
ã“ã“ã§Keyã‚’ç™ºè¡Œã§ãã¾ã™ã€‚ç™ºè¡Œã™ã‚‹éš›ã«ãƒ­ãƒ¼ãƒ«ã‚’é¸æŠã™ã‚‹ã®ã§ã™ãŒã€ã©ã†ã‚„ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ãªã©ã¯Financeã®ãƒ­ãƒ¼ãƒ«ã‚’é¸æŠã—ãªã„ã¨ãƒ€ãƒ¡ã‚‰ã—ã„ã§ã™ã€‚[å‚è€ƒ](https://tech.pepabo.com/2021/03/29/app-store-connect/)

![](/images/eedf5e9179d46a/appstoreconnect.png)

ã“ã“ã®KEY IDã®ã¨ã“ã‚ãŒPrivate Keyã®IDã§ã™ã€‚

æ¬¡ã«payloadã§ã™ã€‚
issã¯ä¸Šã®ç”»åƒã®ç™ºè¡Œè€…IDã€iatã¯ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆæ™‚åˆ»ã€expã¯ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆæ»…æ™‚åˆ»ã§ã™ã€‚

``` Python
payload = {
    "iss": "Your Issuer ID",
    "iat": int(time()),
    "exp": int(mktime(dt.timetuple())),
    "aud": "appstoreconnect-v1",
}
```

ä»¥ä¸Šã®header,payloadã‚’ä½¿ã£ã¦ã€signatureã‚’ç”Ÿæˆã—ã¾ã™ã€‚
signatureã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«æš—å·éµãŒå¿…è¦ã§ã™ã€‚KEYã‚’ç™ºè¡Œã—ãŸãƒšãƒ¼ã‚¸ã‹ã‚‰KEYã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã—ã¾ã™ã€‚ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯å„KEYã«ã¤ã1å›ã®ã¿ãªã®ã§ã‚ã‹ã‚Šã‚„ã™ã„ã¨ã“ã‚ã«ä¿å­˜ã—ã¦ãã ã•ã„ï¼‰

JWTãƒˆãƒ¼ã‚¯ãƒ³ã®ç”Ÿæˆã«ã¯ã€Pythonã®jwtãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä»•æ§˜ã—ã¾ã™ã€‚
ä¸Šè¨˜ã®ä¸€é€£ã®æµã‚Œã‚’æ›¸ã„ãŸã‚‚ã®ãŒæ¬¡ã§ã™ã€‚

``` Python
from datetime import datetime, timedelta
from time import time, mktime
import logging
import jwt

dt = datetime.now() + timedelta(minutes=19)

headers = {
    "alg": "ES256",
    "kid":"Your Private Key ID",
    "typ": "JWT",
}

payload = {
    "iss": "Your Issuer ID",
    "iat": int(time()),
    "exp": int(mktime(dt.timetuple())),
    "aud": "appstoreconnect-v1",
}

with open("AuthKey_PEIVATEKY.p8", "rb") as fh: // é©å®œãƒ•ã‚¡ã‚¤ãƒ«åã‚’å¤‰æ›´ã—ã¦ãã ã•ã„
    signing_key = fh.read()
    
gen_jwt = jwt.encode(payload, signing_key, algorithm="ES256", headers=headers)

print(f"[JWT] {gen_jwt}")
```

ã“ã‚Œã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚Œã¾ã™ã€‚
![](/images/eedf5e9179d46a/jwt.png)

## 2. ç™ºè¡Œã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã§APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ
APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯https://api.appstoreconnect.apple.com/v1/salesReportsã«ãªã‚Šã¾ã™ã€‚

https://developer.apple.com/documentation/appstoreconnectapi/download_sales_and_trends_reports

ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚é©å®œè‡ªåˆ†ã®å–å¾—ã—ãŸã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰æ›´ã—ã¦ãã ã•ã„

``` Python
params = {
    'filter[frequency]':'DAILY',
    'filter[reportDate]':'2023-10-22',
    'filter[reportSubType]': 'SUMMARY',
    'filter[reportType]': 'SALES',
    'filter[vendorNumber]': '87516456'
}
```
ã“ã¡ã‚‰ã®vendorNumberã¯App Store Connectã®Financialã®å·¦ä¸Šã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹éš›ã«æ°—ã‚’ã¤ã‘ã‚‹ã®ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒï¼ã®æ—¥ä»˜ã®å ´åˆã€404ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ã£ã¦ãã¦ã—ã¾ã„ã¾ã™ã€‚ãªã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒã‚ã‚‹æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

``` Python
import urllib.request
import urllib.error

headers = {
  'Authorization': 'Bearer ' + gen_jwt,
  'Accept': '*/*'
}

api_url = 'https://api.appstoreconnect.apple.com/v1/salesReports'

# ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
params = {
    'filter[frequency]':'DAILY',
    'filter[reportDate]':'2023-10-22',
    'filter[reportSubType]': 'SUMMARY',
    'filter[reportType]': 'SALES',
    'filter[vendorNumber]': '87516456'
}

# APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ
req = urllib.request.Request('{}?{}'.format(api_url, urllib.parse.urlencode(params)), headers=headers)

```

## 3. ãƒªã‚¯ã‚¨ã‚¹ãƒˆæˆåŠŸã—ãŸã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æƒ…å ±ç­‰ãŒå«ã¾ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ã‚‰ã‚Œã¦ãã‚‹ã€‚å½¢å¼ã¯gzip
ã„ã‚ˆã„ã‚ˆæœ€å¾Œã®æ®µéšã§ã™ã€‚
ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæˆåŠŸã—ãŸã‚‰gzipã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦ãã¾ã™ã€‚
ä»Šå›ã¯ãã‚Œã‚’jsonå½¢å¼ã§ä¿å­˜ã—ã¾ã—ãŸã€‚

``` Python
try:
    with urllib.request.urlopen(req) as res:
        # GZIPãƒ‡ãƒ¼ã‚¿ã‚’è§£å‡ã—ã¦ä¿å­˜
        with gzip.open(res, 'rb') as gzipped_file:
            output_file = "hoge.json"
            try:
                decompressed_data = gzipped_file.read()
                with open(output_file, 'wb') as output:
                    output.write(decompressed_data)
                print(f"ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸ: {output_file}")
            except Exception as e:
                print(f"ãƒ‡ãƒ¼ã‚¿ã®è§£å‡ã¨ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: {str(e)}")
    code = 200
    
except (urllib.error.HTTPError, urllib.error.URLError) as e:
    logging.error("Error occurred in urllib.request.Request().\n code: " + str(e.code) + \
                    "\n reason: " + e.reason)
    code = e.code
    content = e.reason
```

æˆåŠŸã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªãƒ¬ãƒãƒ¼ãƒˆãŒå–å¾—ã§ãã¾ã™ã€‚
![](/images/eedf5e9179d46a/hogejson.png)

ã“ã‚Œã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ãªã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
ãŸã ã€å€‹äººçš„ã«ã¯App Analyticsã®ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°ãªã©ã‚’å–å¾—ã§ããªã‹ã£ãŸã®ãŒæ®‹å¿µã§ã™ã€‚
ã¾ãŸã€æ•´å½¢ã—ãŸã‚Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒãªã„æ—¥ä»˜ã®å ´åˆã¯404ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ãªã£ã¦ã—ã¾ã†ã€ã¨ã„ã†æ„Ÿã˜ã§ä½¿ã„å‹æ‰‹ãŒæ‚ªãã†ãªã®ã§ã€Firebase Analyticsã‹ã‚‰ã„ã„æ„Ÿã˜ã§ã§ããªã„ã‹ã‚’ä»Šåº¦ã¯è©¦ã—ã¦ã¿ã‚‹ã¤ã‚‚ã‚Šã§ã™ã€‚

ã”è¦§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

***
## å‚è€ƒã‚µã‚¤ãƒˆ
- [App Store Connect APIã‹ã‚‰æ–°è¦DLæ•°ã‚’å–å¾—](https://tech.pepabo.com/2021/03/29/app-store-connect/)
- [Sales and Trends reports availability
](https://developer.apple.com/help/app-store-connect/reference/sales-and-trends-reports-availability)
- [ã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ•°åé›†ã‚’GCPã§å®Ÿè£…ã—ã¦ã¿ã‚‹
](https://lab.mo-t.com/blog/andonlabo-app-downloads-collector)